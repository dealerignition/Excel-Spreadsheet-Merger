require 'csv'
require 'postgres-pr/connection'

client = PostgresPR::Connection.new("playspace","bulletshot60","","tcp://localhost:5432")

CSV.foreach("merge1.csv",:headers => true) do |row|
  puts("insert into dealers(name,phone,address,city,state,postal,primary_email,website,owner,sources_count,source1,source2,source3,source4,source5,source6,source7,contacts_count,contact1,contact2,contact3,contact4,contact5,other_emails_count,other_email1,other_email2,other_email3,other_email4,other_email5,other_email6,other_email7,other_email8,other_email9,other_email10,other_email11,other_email12,other_email13,other_email14,other_email15,other_email16,other_email17,other_email18,other_email19,other_email20,other_email21) values ('#{row["name"]}','#{row["phone"]}','#{row["address"]}','#{row["city"]}','#{row["state"]}','#{row["postal"]}','#{row["primary_email"]}','#{row["website"]}','#{row["owner"]}','#{row["sources_count"]}','#{row["source1"]}','#{row["source2"]}','#{row["source3"]}','#{row["source4"]}','#{row["source5"]}','#{row["source6"]}','#{row["source7"]}','#{row["contacts_count"]}','#{row["contact1"]}','#{row["contact2"]}','#{row["contact3"]}','#{row["contact4"]}','#{row["contact5"]}',#{row["other_emails_count"]},'#{row["other_email1"]}','#{row["other_email2"]}','#{row["other_email3"]}','#{row["other_email4"]}','#{row["other_email5"]}','#{row["other_email6"]}','#{row["other_email7"]}','#{row["other_email8"]}','#{row["other_email9"]}','#{row["other_email10"]}','#{row["other_email11"]}','#{row["other_email12"]}','#{row["other_email13"]}','#{row["other_email14"]}','#{row["other_email15"]}','#{row["other_email16"]}','#{row["other_email17"]}','#{row["other_email18"]}','#{row["other_email19"]}','#{row["other_email20"]}','#{row["other_email21"]}');")
end
