require 'postgres-pr/connection'
require 'csv'

client = PostgresPR::Connection.new("playspace","bulletshot60","","tcp://localhost:5432")

CSV.foreach("merge1.csv", :headers => true) do |row|
  client.query("insert into dealers(phone,address,city,state,postal,primary_email,sources_count,source1,source2,source3,source4,source5,source6,source7,names_count,name1,name2,name3,name4,name5,name6,name7,name8,name9,name10,name11,name12,name13,owners_count,owner_first_name1,owner_last_name1,owner_first_name2,owner_last_name2,owner_first_name3,owner_last_name3,owner_first_name4,owner_last_name4,owner_first_name5,owner_last_name5,owner_first_name6,owner_last_name6,owner_first_name7,owner_last_name7,owner_first_name8,owner_last_name8,contacts_count,contact_first_name1,contact_last_name1,contact_first_name2,contact_last_name2,contact_first_name3,contact_last_name3,contact_first_name4,contact_last_name4,contact_first_name5,contact_last_name5,other_emails_count,other_email1,other_email2,other_email3,other_email4,other_email5,other_email6,other_email7,other_email8,other_email9,other_email10,other_email11,other_email12,other_email13,other_email14,other_email15,other_email16,other_email17,other_email18,other_email19,other_email20,other_email21,other_email22,other_email23,other_email24,other_email25,other_email26,other_email27,other_email28,other_email29,other_email30,other_email31,other_email32,other_email33,other_email34,other_email35,other_email36,other_email37,other_email38,other_email39,other_email40,other_email41,other_email42,websites_count,website1,website2,website3,website4,website5,website6,website7,website8,website9) values ('#{row["phone"]}','#{row["address"]}','#{row["city"]}','#{row["state"]}','#{row["postal"]}','#{row["primary_email"]}','#{row["sources_count"]}','#{row["source1"]}','#{row["source2"]}','#{row["source3"]}','#{row["source4"]}','#{row["source5"]}','#{row["source6"]}','#{row["source7"]}','#{row["names_count"]}','#{row["name1"]}','#{row["name2"]}','#{row["name3"]}','#{row["name4"]}','#{row["name5"]}','#{row["name6"]}','#{row["name7"]}','#{row["name8"]}','#{row["name9"]}','#{row["name10"]}','#{row["name11"]}','#{row["name12"]}','#{row["name13"]}','#{row["owners_count"]}','#{row["owner_first_name1"]}','#{row["owner_last_name1"]}','#{row["owner_first_name2"]}','#{row["owner_last_name2"]}','#{row["owner_first_name3"]}','#{row["owner_last_name3"]}','#{row["owner_first_name4"]}','#{row["owner_last_name4"]}','#{row["owner_first_name5"]}','#{row["owner_last_name5"]}','#{row["owner_first_name6"]}','#{row["owner_last_name6"]}','#{row["owner_first_name7"]}','#{row["owner_last_name7"]}','#{row["owner_first_name8"]}','#{row["owner_last_name8"]}','#{row["contacts_count"]}','#{row["contact_first_name1"]}','#{row["contact_last_name1"]}','#{row["contact_first_name2"]}','#{row["contact_last_name2"]}','#{row["contact_first_name3"]}','#{row["contact_last_name3"]}','#{row["contact_first_name4"]}','#{row["contact_last_name4"]}','#{row["contact_first_name5"]}','#{row["contact_last_name5"]}','#{row["other_emails_count"]}','#{row["other_email1"]}','#{row["other_email2"]}','#{row["other_email3"]}','#{row["other_email4"]}','#{row["other_email5"]}','#{row["other_email6"]}','#{row["other_email7"]}','#{row["other_email8"]}','#{row["other_email9"]}','#{row["other_email10"]}','#{row["other_email11"]}','#{row["other_email12"]}','#{row["other_email13"]}','#{row["other_email14"]}','#{row["other_email15"]}','#{row["other_email16"]}','#{row["other_email17"]}','#{row["other_email18"]}','#{row["other_email19"]}','#{row["other_email20"]}','#{row["other_email21"]}','#{row["other_email22"]}','#{row["other_email23"]}','#{row["other_email24"]}','#{row["other_email25"]}','#{row["other_email26"]}','#{row["other_email27"]}','#{row["other_email28"]}','#{row["other_email29"]}','#{row["other_email30"]}','#{row["other_email31"]}','#{row["other_email32"]}','#{row["other_email33"]}','#{row["other_email34"]}','#{row["other_email35"]}','#{row["other_email36"]}','#{row["other_email37"]}','#{row["other_email38"]}','#{row["other_email39"]}','#{row["other_email40"]}','#{row["other_email41"]}','#{row["other_email42"]}','#{row["websites_count"]}','#{row["website1"]}','#{row["website2"]}','#{row["website3"]}','#{row["website4"]}','#{row["website5"]}','#{row["website6"]}','#{row["website7"]}','#{row["website8"]}','#{row["website9"]}');")
end

